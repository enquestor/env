---
- name: "[macOS] Install required packages"
  when: os == "MacOSX"
  become: true
  homebrew:
    name: "{{ packages_macos }}"
    state: latest

- name: "[macOS] Adjust dock hide speed"
  when: os == "MacOSX"
  shell:
    executable: bash
    cmd: defaults write com.apple.dock autohide-delay -int 0 && defaults write com.apple.dock autohide-time-modifier -float 0.4 && killall Dock

- name: "[Ubuntu] Add fish apt repository"
  when: os == "Ubuntu"
  become: true
  shell:
    executable: bash
    cmd: apt-add-repository ppa:fish-shell/release-3

- name: "[Ubuntu] Install required packages for Ubuntu"
  when: os == "Ubuntu"
  become: true
  apt:
    name: "{{ packages_ubuntu }}"
    state: latest

- name: Check if vimrc is provided
  delegate_to: localhost
  stat:
    path: "{{ vimrc_path }}"
  register: vimrc_file

- name: Populate .vimrc
  when: vimrc_file.stat.exists
  copy: 
    src: "{{ vimrc_path }}"
    dest: ~/.vimrc

- name: Check if gitconfig is provided
  delegate_to: localhost
  stat:
    path: "{{ git_config_path }}"
  register: git_config_file

- name: Populate .gitconfig
  when: git_config_file.stat.exists
  copy: 
    src: "{{ git_config_path }}"
    dest: ~/.gitconfig